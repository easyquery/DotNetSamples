{"version":3,"names":["AdvacnedSearchHtml","h","class","id","href","style","float","width","display","marginLeft","fontSize","Date","getFullYear","target","easyQueryCss","EasyQuery","constructor","hostRef","this","QUERY_KEY","componentWillLoad","viewOptions","shadowRoots","host","shadowRoot","enableExport","serverExporters","loadModelOnStart","loadQueryOnStart","handlers","onError","_","error","console","sourceError","widgets","resultGrid","paging","enabled","pageSize","result","showChart","view","AdvancedSearchView","context","getContext","useEndpoint","useEnterprise","init","addEventListener","query","getQuery","addChangedCallback","data","JSON","stringify","modified","isModified","toJSONData","localStorage","setItem","loadQueryFromLocalStorage","dataJson","getItem","parse","loadFromDataOrJson","fireChangedEvent","refreshWidgets","syncQuery","setTimeout","fetchData","render","key"],"sources":["src/components/easy-query/easy-query-html.tsx","src/components/easy-query/easy-query.css?tag=easy-query&encapsulation=shadow","src/components/easy-query/easy-query.tsx"],"sourcesContent":["import { FunctionalComponent, h } from '@stencil/core';\r\n\r\nexport const AdvacnedSearchHtml: FunctionalComponent = () => (\r\n    <div>\r\n        <div class=\"eqjs-process-bar\" id=\"ProcessBar\"></div>\r\n            <div id=\"main\">\r\n            <div class=\"eqv-header\">\r\n                    <div class=\"eqv-title\">EasyQuery</div>\r\n                    <div class=\"eqv-sub-title\">Friendly ad-hoc query builder for your web-site</div>\r\n                </div>\r\n                <div id=\"eqv-content\">\r\n                    <div class=\"eqv-header-panel\">\r\n                        <div class=\"eqv-entities-block\">\r\n                            <hr class=\"eqv-entities-hr eqv-hr\" />\r\n                            <div class=\"eqv-entities-title\">Entities</div>\r\n                            <div class=\"eqv-entities-panel-container\">\r\n                            <div id=\"EntitiesPanel\"></div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class=\"eqv-central-block\">\r\n                            <div class=\"eqv-columns-block\">\r\n                                <hr class=\"eqv-columns-hr eqv-hr\" />\r\n                                <div class=\"eqv-columns-title\">Columns</div>\r\n                                <div class=\"eqv-columns-panel-container\">\r\n\r\n                                <div id=\"ColumnsPanel\"></div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"eqv-conditions-block\">\r\n                                <hr class=\"eqv-conditions-hr eqv-hr\" />\r\n                                <div class=\"eqv-conditions-title\">Conditions</div>\r\n                                <div class=\"eqv-query-panel-container\">\r\n  \r\n                                <div id=\"QueryPanel\"></div>\r\n                                </div>\r\n                            </div>\r\n                    </div>\r\n                    <div class=\"eqv-menu-block\">\r\n                        <hr class=\"eqv-menu-hr eqv-hr\" />\r\n                        <div class=\"eqv-menu-title\">Query Menu</div>\r\n                        <div class=\"eqv-menu-content\">\r\n\r\n                            <div id=\"QueryNameLabel\"></div>\r\n\r\n\r\n                            <a id=\"ClearQueryButton\" class=\"eqv-button\">Clear</a>\r\n\r\n\r\n                            <div class=\"eqv-dropdown-container\">\r\n                                <a id=\"LoadQueryButton\" href=\"javascript::void(0)\" class=\"eqv-button eqv-drop-button\">Load <span style={{ float: \"right\" }}>▼</span></a>\r\n                                <div class=\"eqv-dropdown-content\">\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"eqv-dropdown-container\">\r\n                                <a id=\"StorageDropButton\" class=\"eqv-button eqv-drop-button\">Storage <span style={{ float: \"right\" }}>▼</span></a>\r\n                                <div class=\"eqv-dropdown-content\">\r\n                                    <a id=\"NewQueryButton\" href=\"javascript::void(0)\">New query</a>\r\n                                    <a id=\"SaveQueryButton\" href=\"javascript::void(0)\">Save query</a>\r\n                                    <a id=\"CopyQueryButton\" href=\"javascript::void(0)\">Save query as...</a>\r\n                                    <a id=\"RemoveQueryButton\" href=\"javascript::void(0)\">Remove query</a>\r\n                                </div>\r\n                            </div>\r\n\r\n\r\n                            <a id=\"FetchDataButton\" href=\"javascript::void(0)\" class=\"eqv-button eqv-button-execute\">Fetch data</a>\r\n                        </div>\r\n                    </div>\r\n                    </div>\r\n                     <div class=\"eqv-bottom-panel\">\r\n                        <div class=\"eqv-result-panel\" style={{ width:'100%' }}>\r\n                            <hr class=\"eqv-result-panel-hr eqv-hr\" />\r\n                            <div class=\"eqv-result-panel-title\">\r\n                                Result\r\n                                <span id=\"ResultCount\" style={{display:'none', marginLeft:'20px', fontSize:'small'}}></span>\r\n                                <span class=\"eqv-export-buttons\">\r\n                                    <a class=\"eqjs-export\" href=\"javascript:void(0)\" data-format=\"pdf\">Export to PDF</a>\r\n                                    <a class=\"eqjs-export\" href=\"javascript:void(0)\" data-format=\"excel\">Export to Excel</a>\r\n                                    <a class=\"eqjs-export\" href=\"javascript:void(0)\" data-format=\"csv\">Export to CSV</a>\r\n                                </span>\r\n                            </div>\r\n                            <div id=\"ResultPanel\" class=\"eqv-result-panel-content\">\r\n                            </div>\r\n                            <div class=\"eqv-result-panel-content-padding\">\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n                <div id=\"eqv-footer\">\r\n                    <div class=\"eqv-copyright\">\r\n                        (c) Copyright 2006-{new Date().getFullYear()} <a href=\"https://korzh.com/\" target=\"_blank\">Korzh.com</a>\r\n                    </div>\r\n                    <div class=\"power-by\">\r\n                        Powered by <a href=\"https://korzh.com/easyquery\" target=\"_blank\">EasyQuery</a>\r\n                        |\r\n                        <a href=\"http://demo.easyquerybuilder.com\" target=\"_blank\">Live demos</a>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>);\r\n\r\nexport default AdvacnedSearchHtml;","@import \"../../../node_modules/@easyquery/ui/dist/assets/css/easyquery.ui.css\";\r\n","import { Component, Element, h } from '@stencil/core';\r\nimport { AdvacnedSearchHtml } from './easy-query-html';\r\n\r\nimport { EqContext } from '@easyquery/core';\r\nimport { AdvancedSearchView, EqViewOptions } from '@easyquery/ui';\r\nimport '@easyquery/enterprise';\r\n\r\n@Component({\r\n    tag: 'easy-query',\r\n    styleUrl: './easy-query.css',\r\n    shadow: true\r\n})\r\nexport class EasyQuery {\r\n\r\n    private view: AdvancedSearchView;\r\n    private context: EqContext;\r\n\r\n    @Element() host: HTMLDivElement;\r\n\r\n    QUERY_KEY = 'easyquerycomponent-query';\r\n    \r\n    componentWillLoad() {\r\n        const viewOptions: EqViewOptions = {\r\n            shadowRoots: [ this.host.shadowRoot ],\r\n            enableExport: true,\r\n            serverExporters: [ 'pdf', 'excel', 'csv' ],\r\n            loadModelOnStart: true,\r\n            loadQueryOnStart: false,\r\n\r\n            handlers: {\r\n              onError: (_, error) => {\r\n                console.error(error.sourceError);\r\n              }\r\n            },\r\n            widgets: {\r\n              resultGrid: {\r\n                paging: {\r\n                    enabled: true,\r\n                    pageSize: 30\r\n                }\r\n              }\r\n            },\r\n            result: {\r\n              showChart: true\r\n            }\r\n        }\r\n\r\n        this.view = new AdvancedSearchView();\r\n        this.context = this.view.getContext();\r\n\r\n        this.context\r\n            .useEndpoint('/api/easyquery')\r\n            .useEnterprise(() => {\r\n                this.view.init(viewOptions);\r\n            });\r\n\r\n        this.context.addEventListener('ready', () => {\r\n            const query = this.context.getQuery();\r\n\r\n            query.addChangedCallback(() => {\r\n                const data = JSON.stringify({\r\n                    modified: query.isModified(),\r\n                    query: query.toJSONData()\r\n                });\r\n                localStorage.setItem(this.QUERY_KEY, data);\r\n            });\r\n\r\n            //add load query from local storage\r\n            this.loadQueryFromLocalStorage();\r\n        });\r\n    }\r\n\r\n    loadQueryFromLocalStorage() {\r\n        const dataJson = localStorage.getItem(this.QUERY_KEY);\r\n        if (dataJson) {\r\n            const data = JSON.parse(dataJson);\r\n            const query = this.context.getQuery();\r\n            query.loadFromDataOrJson(data.query);\r\n            if (data.modified) {\r\n                query.fireChangedEvent();\r\n            }\r\n            else {\r\n                this.view.getContext().refreshWidgets();\r\n                this.view.syncQuery();\r\n            }\r\n\r\n            setTimeout(() => this.view.fetchData(), 100);\r\n        }\r\n    };    \r\n\r\n\r\n    render() {\r\n        return (<AdvacnedSearchHtml />)\r\n    }\r\n}"],"mappings":"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","ignoreList":[]}